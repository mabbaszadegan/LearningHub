<link rel="stylesheet" href="~/css/areas/teacher/schedule-items/written-content-builder.css" asp-append-version="true" />

@model EduTrack.Application.Common.Models.ScheduleItems.CreateScheduleItemRequest

<div class="written-content-builder">
    <div class="content-builder-container">
        <div class="blocks-section">
            <div class="blocks-list" id="questionBlocksList">
                <!-- Question blocks will be added here dynamically -->
                <div class="empty-state" id="emptyQuestionBlocksState">
                    <div class="empty-state-icon">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <h4>هنوز سوالی اضافه نشده</h4>
                    <p>برای شروع، روی دکمه "افزودن سوال" کلیک کنید</p>
                </div>
            </div>
        </div>
        
        <div class="preview-section" style="display: none;">
            <div class="content-preview">
                <div class="preview-header">
                    <h4>پیش‌نمایش تمرین نوشتاری</h4>
                </div>
                <div class="preview-content" id="writtenPreview">
                    <div class="written-exercise-card">
                        <div class="exercise-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="exercise-text">
                            <p>تمرین نوشتاری شما اینجا نمایش داده خواهد شد...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Question Block Templates -->
<div id="questionBlockTemplates" style="display: none;">
    @{
        ViewData["IsQuestionBlock"] = "true";
    }
    
    @await Html.PartialAsync("_TextBlock", new { BlockType = "text" })
    @await Html.PartialAsync("_ImageBlock", new { BlockType = "image" })
    @await Html.PartialAsync("_VideoBlock", new { BlockType = "video" })
    @await Html.PartialAsync("_AudioBlock", new { BlockType = "audio" })
    @await Html.PartialAsync("_CodeBlock", new { BlockType = "code" })
</div>

@{
    ViewData["ModalId"] = "questionTypeModal";
    ViewData["ModalTitle"] = "انتخاب نوع سوال";
    ViewData["ModalLabel"] = "questionTypeModalLabel";
}
@await Html.PartialAsync("_BlockTypeSelectionModal")

<!-- Preview Modal -->
<div class="modal fade" id="writtenPreviewModal" tabindex="-1" aria-labelledby="writtenPreviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="writtenPreviewModalLabel">
                    <i class="fas fa-eye"></i>
                    پیش‌نمایش تمرین نوشتاری
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="preview-container">
                    <div class="preview-content" id="modalWrittenPreview">
                        <div class="written-exercise-card">
                            <div class="exercise-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="exercise-text">
                                <p>تمرین نوشتاری شما اینجا نمایش داده خواهد شد...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-teacher btn-secondary" data-bs-dismiss="modal">بستن</button>
                <button type="button" class="btn-teacher btn-primary" onclick="updateWrittenPreview()">
                    <i class="fas fa-sync-alt"></i>
                    <span>به‌روزرسانی پیش‌نمایش</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Hidden field for content -->
<input type="hidden" id="writtenContentJson" name="WrittenContentJson" value="@Model.ContentJson" />

<script src="~/js/areas/teacher/schedule-items/written-content-builder.js" asp-append-version="true"></script>

