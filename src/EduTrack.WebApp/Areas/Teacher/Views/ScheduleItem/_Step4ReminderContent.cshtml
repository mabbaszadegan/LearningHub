<link rel="stylesheet" href="~/css/areas/teacher/schedule-items/reminder-content-builder.css" asp-append-version="true" />

@model EduTrack.Application.Common.Models.ScheduleItems.CreateScheduleItemRequest

<div class="reminder-content-builder">
    <div class="content-builder-container">
        <div class="blocks-section">
            <div class="blocks-list" id="contentBlocksList">
                <!-- Content blocks will be added here dynamically -->
                <div class="empty-state" id="emptyBlocksState">
                    <div class="empty-state-icon">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <h4>هنوز بلاکی اضافه نشده</h4>
                    <p>برای شروع، روی دکمه "افزودن بلاک" کلیک کنید</p>
                </div>
            </div>
        </div>
        
        <div class="preview-section" style="display: none;">
            <div class="content-preview">
                <div class="preview-header">
                    <h4>پیش‌نمایش یادآوری</h4>
                </div>
                <div class="preview-content" id="reminderPreview">
                    <div class="reminder-card">
                        <div class="reminder-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="reminder-text">
                            <p>محتوای یادآوری شما اینجا نمایش داده خواهد شد...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Content Block Templates -->
<div id="contentBlockTemplates" style="display: none;">
    @{
        ViewData["IsQuestionBlock"] = "false";
    }
    
    @await Html.PartialAsync("_TextBlock", new { BlockType = "text" })
    @await Html.PartialAsync("_ImageBlock", new { BlockType = "image" })
    @await Html.PartialAsync("_VideoBlock", new { BlockType = "video" })
    @await Html.PartialAsync("_AudioBlock", new { BlockType = "audio" })
    @await Html.PartialAsync("_CodeBlock", new { BlockType = "code" })
</div>
        
@{
    ViewData["ModalId"] = "blockTypeModal";
    ViewData["ModalTitle"] = "انتخاب نوع بلاک";
    ViewData["ModalLabel"] = "blockTypeModalLabel";
}
@await Html.PartialAsync("_BlockTypeSelectionModal")

<!-- Hidden field for content -->
<input type="hidden" id="reminderContentJson" name="ReminderContentJson" value="@Model.ContentJson" />

<!-- Link Dialog Modal -->
<div class="modal fade" id="linkDialogModal" tabindex="-1" aria-labelledby="linkDialogModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="linkDialogModalLabel">
                    <i class="fas fa-link"></i>
                    افزودن لینک
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="linkText">متن لینک:</label>
                    <input type="text" class="form-control" id="linkText" placeholder="متن لینک را وارد کنید">
                </div>
                <div class="form-group">
                    <label for="linkUrl">آدرس لینک:</label>
                    <input type="url" class="form-control" id="linkUrl" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label for="linkTarget">نحوه باز شدن:</label>
                    <select class="form-control" id="linkTarget">
                        <option value="_self">همان پنجره</option>
                        <option value="_blank">پنجره جدید</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">انصراف</button>
                <button type="button" class="btn btn-primary" id="insertLinkBtn">افزودن لینک</button>
            </div>
        </div>
    </div>
</div>

<!-- Text Formatting Dialog Modal -->
<div class="modal fade" id="textFormattingModal" tabindex="-1" aria-labelledby="textFormattingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="textFormattingModalLabel">
                    <i class="fas fa-paint-brush"></i>
                    فرمت‌بندی متن
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="textSize">اندازه متن:</label>
                            <select class="form-control" id="textSize">
                                <option value="12px">خیلی کوچک (12px)</option>
                                <option value="14px">کوچک (14px)</option>
                                <option value="16px" selected>معمولی (16px)</option>
                                <option value="18px">متوسط (18px)</option>
                                <option value="20px">بزرگ (20px)</option>
                                <option value="24px">خیلی بزرگ (24px)</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="textColor">رنگ متن:</label>
                            <input type="color" class="form-control" id="textColor" value="#000000">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="backgroundColor">رنگ پس‌زمینه:</label>
                            <input type="color" class="form-control" id="backgroundColor" value="#ffffff">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="textAlign">تراز متن:</label>
                            <select class="form-control" id="textAlign">
                                <option value="right" selected>راست</option>
                                <option value="center">وسط</option>
                                <option value="left">چپ</option>
                                <option value="justify">تمام عرض</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">انصراف</button>
                <button type="button" class="btn btn-primary" id="applyTextFormattingBtn">اعمال فرمت</button>
            </div>
        </div>
    </div>
</div>

<!-- Code Block Dialog Modal -->
<div class="modal fade" id="codeBlockModal" tabindex="-1" aria-labelledby="codeBlockModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="codeBlockModalLabel">
                    <i class="fas fa-code"></i>
                    بلاک کد برنامه‌نویسی
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="codeLanguage">زبان برنامه‌نویسی:</label>
                            <select class="form-control" id="codeLanguage">
                                <option value="javascript">JavaScript</option>
                                <option value="python">Python</option>
                                <option value="csharp">C#</option>
                                <option value="java">Java</option>
                                <option value="html">HTML</option>
                                <option value="css">CSS</option>
                                <option value="sql">SQL</option>
                                <option value="json">JSON</option>
                                <option value="xml">XML</option>
                                <option value="plaintext">Plain Text</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="codeTheme">تم رنگی:</label>
                            <select class="form-control" id="codeTheme">
                                <option value="default">پیش‌فرض</option>
                                <option value="dark">تیره</option>
                                <option value="light">روشن</option>
                                <option value="monokai">Monokai</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="codeTitle">عنوان کد (اختیاری):</label>
                            <input type="text" class="form-control" id="codeTitle" placeholder="عنوان کد را وارد کنید">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="codeContent">محتوای کد:</label>
                    <textarea class="form-control" id="codeContent" rows="15" placeholder="کد خود را اینجا وارد کنید..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">انصراف</button>
                <button type="button" class="btn btn-primary" id="insertCodeBlockBtn">افزودن بلاک کد</button>
            </div>
        </div>
    </div>
</div>

<!-- Preview Modal -->
<div class="modal fade" id="previewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="previewModalLabel">
                    <i class="fas fa-eye"></i>
                    پیش‌نمایش محتوای یادآوری
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="preview-container">
                    <div class="preview-content" id="modalReminderPreview">
                        <div class="reminder-card">
                            <div class="reminder-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="reminder-text">
                                <p>محتوای یادآوری شما اینجا نمایش داده خواهد شد...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-teacher btn-secondary" data-bs-dismiss="modal">بستن</button>
                <button type="button" class="btn-teacher btn-primary" onclick="updatePreview()">
                    <i class="fas fa-sync-alt"></i>
                    <span>به‌روزرسانی پیش‌نمایش</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Styles and Scripts are included in the main Create.cshtml view -->

<script src="~/js/areas/teacher/schedule-items/reminder-content-builder.js" asp-append-version="true"></script>